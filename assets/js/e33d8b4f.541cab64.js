/*! For license information please see e33d8b4f.541cab64.js.LICENSE.txt */
"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([[296004],{569037:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>d,frontMatter:()=>s,metadata:()=>c,toc:()=>u});var r=t(824246),o=t(511151);const s={id:"plugin-conversion",title:"Converting 3rd-party plugins from the old system",sidebar_label:"Converting 3rd-party Plugins",description:"Documentation for how to convert 3rd-party plugins to support the new frontend system."},i=void 0,c={id:"frontend-system/building-apps/plugin-conversion",title:"Converting 3rd-party plugins from the old system",description:"Documentation for how to convert 3rd-party plugins to support the new frontend system.",source:"@site/../docs/frontend-system/building-apps/06-plugin-conversion.md",sourceDirName:"frontend-system/building-apps",slug:"/frontend-system/building-apps/plugin-conversion",permalink:"/docs/frontend-system/building-apps/plugin-conversion",draft:!1,unlisted:!1,editUrl:"https://github.com/backstage/backstage/edit/master/docs/../docs/frontend-system/building-apps/06-plugin-conversion.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{id:"plugin-conversion",title:"Converting 3rd-party plugins from the old system",sidebar_label:"Converting 3rd-party Plugins",description:"Documentation for how to convert 3rd-party plugins to support the new frontend system."},sidebar:"docs",previous:{title:"Built-in extensions",permalink:"/docs/frontend-system/building-apps/built-in-extensions"},next:{title:"Migration Guide",permalink:"/docs/frontend-system/building-apps/migrating"}},a={},u=[{value:"Converting a legacy plugin",id:"converting-a-legacy-plugin",level:2},{value:"Converting legacy extensions",id:"converting-legacy-extensions",level:2},{value:"Overriding inferred parameters",id:"overriding-inferred-parameters",level:3},{value:"Other types of extensions",id:"other-types-of-extensions",level:3},{value:"Putting it all together",id:"putting-it-all-together",level:2}];function l(e){const n={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["If you are using or want to use a 3rd-party plugin that does not yet support the new frontend system in your app, you can often use conversion utilities from ",(0,r.jsx)(n.code,{children:"@backstage/core-compat-api"})," in order wrap the plugin to make it possible to install in your app."]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"[!CAUTION]\nThe purpose of these utilities is to wrap 3rd-party plugins. Do not use them for your own plugins where you can add support for the new frontend system directly."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"converting-a-legacy-plugin",children:"Converting a legacy plugin"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"@backstage/core-compat-api"})," package exports the ",(0,r.jsx)(n.code,{children:"convertLegacyPlugin"})," function that can be used to convert a legacy plugin to the new frontend system. Simply pass in the old plugin instance and the new plugin will be returned."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import { techdocsPlugin } from '@backstage/plugin-techdocs';\n\n// TechDocs is used as an example here, it already supports\n// the new frontend system so don't use this code directly.\nconst convertedTechdocsPlugin = convertLegacyPlugin(techdocsPlugin, {\n  extensions: [],\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Note that when using ",(0,r.jsx)(n.code,{children:"convertLegacyPlugin"})," we also have to pass an array of extensions. This is because the ",(0,r.jsx)(n.code,{children:"convertLegacyPlugin"})," function does not have access to or know about the different types of extensions in the old system. You instead need to manually convert each of the old extensions that you want to include in the plugin instance."]}),"\n",(0,r.jsx)(n.h2,{id:"converting-legacy-extensions",children:"Converting legacy extensions"}),"\n",(0,r.jsxs)(n.p,{children:["As mentioned above, you need to manually convert each of the old extensions that you want to include in the plugin instance. The ",(0,r.jsx)(n.code,{children:"@backstage/core-compat-api"})," package exports ",(0,r.jsx)(n.code,{children:"convertLegacyPageExtension"})," for this purpose, which can be used to convert a top-level page extension to the new system. Simply pass in the old extension and the new extension will be returned."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const convertedIndexPage = convertLegacyPageExtension(TechDocsIndexPage);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"overriding-inferred-parameters",children:"Overriding inferred parameters"}),"\n",(0,r.jsxs)(n.p,{children:["The conversion functions such as ",(0,r.jsx)(n.code,{children:"convertLegacyPageExtension"})," will attempt to infer parameters from the old extension, in particular it uses the name of the old extension to determine things like the name and route paths of the new extension. In some cases you may need to supply your own parameters to the conversion function if the inferred values are not correct."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const convertedIndexPage = convertLegacyPageExtension(TechDocsIndexPage, {\n  name: 'index',\n  defaultPath: '/docs',\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"other-types-of-extensions",children:"Other types of extensions"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"@backstage/core-compat-api"})," only provides conversion functions for the built-in extension types, i.e. only page extensions. There are many plugins that define their own extension types, such as the entity content and card extensions for the catalog. For those cases it's up to the plugin libraries to provide their own conversion functions for these types of extensions. For example, ",(0,r.jsx)(n.code,{children:"@backstage/plugin-catalog-react/alpha"})," provides both ",(0,r.jsx)(n.code,{children:"convertLegacyEntityContentExtension"})," and ",(0,r.jsx)(n.code,{children:"convertLegacyEntityCardExtension"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"The following are the known conversion functions provided by various libraries:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"convertLegacyPageExtension"})," - ",(0,r.jsx)(n.code,{children:"@backstage/core-compat-api"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"convertLegacyEntityContentExtension"})," - ",(0,r.jsx)(n.code,{children:"@backstage/plugin-catalog-react/alpha"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"convertLegacyEntityCardExtension"})," - ",(0,r.jsx)(n.code,{children:"@backstage/plugin-catalog-react/alpha"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"putting-it-all-together",children:"Putting it all together"}),"\n",(0,r.jsx)(n.p,{children:"Using the plugin converter along with extension converters from various libraries, we can not more fully convert our 3rd-party plugin to be able to install it in an app built with the new frontend system:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import {\n  techdocsPlugin,\n  TechDocsIndexPage,\n  TechDocsReaderPage,\n  EntityTechdocsContent,\n} from '@backstage/plugin-techdocs';\n\nconst convertedTechdocsPlugin = convertLegacyPlugin(techdocsPlugin, {\n  extensions: [\n    convertLegacyPageExtension(TechDocsIndexPage, {\n      name: 'index',\n      defaultPath: '/docs',\n    }),\n    convertLegacyPageExtension(TechDocsReaderPage, {\n      defaultPath: '/docs/:namespace/:kind/:name/*',\n    }),\n    convertLegacyEntityContentExtension(EntityTechdocsContent),\n  ],\n});\n\nconst app = createApp({\n  features: [convertedTechdocsPlugin],\n});\n"})})]})}function d(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},371426:(e,n,t)=>{var r=t(827378),o=Symbol.for("react.element"),s=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,c=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function u(e,n,t){var r,s={},u=null,l=null;for(r in void 0!==t&&(u=""+t),void 0!==n.key&&(u=""+n.key),void 0!==n.ref&&(l=n.ref),n)i.call(n,r)&&!a.hasOwnProperty(r)&&(s[r]=n[r]);if(e&&e.defaultProps)for(r in n=e.defaultProps)void 0===s[r]&&(s[r]=n[r]);return{$$typeof:o,type:e,key:u,ref:l,props:s,_owner:c.current}}n.Fragment=s,n.jsx=u,n.jsxs=u},541535:(e,n)=>{var t=Symbol.for("react.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),a=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,g={};function m(e,n,t){this.props=e,this.context=n,this.refs=g,this.updater=t||h}function v(){}function x(e,n,t){this.props=e,this.context=n,this.refs=g,this.updater=t||h}m.prototype.isReactComponent={},m.prototype.setState=function(e,n){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=m.prototype;var b=x.prototype=new v;b.constructor=x,y(b,m.prototype),b.isPureReactComponent=!0;var _=Array.isArray,j=Object.prototype.hasOwnProperty,w={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function P(e,n,r){var o,s={},i=null,c=null;if(null!=n)for(o in void 0!==n.ref&&(c=n.ref),void 0!==n.key&&(i=""+n.key),n)j.call(n,o)&&!k.hasOwnProperty(o)&&(s[o]=n[o]);var a=arguments.length-2;if(1===a)s.children=r;else if(1<a){for(var u=Array(a),l=0;l<a;l++)u[l]=arguments[l+2];s.children=u}if(e&&e.defaultProps)for(o in a=e.defaultProps)void 0===s[o]&&(s[o]=a[o]);return{$$typeof:t,type:e,key:i,ref:c,props:s,_owner:w.current}}function E(e){return"object"==typeof e&&null!==e&&e.$$typeof===t}var C=/\/+/g;function S(e,n){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return n[e]}))}(""+e.key):n.toString(36)}function T(e,n,o,s,i){var c=typeof e;"undefined"!==c&&"boolean"!==c||(e=null);var a=!1;if(null===e)a=!0;else switch(c){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case t:case r:a=!0}}if(a)return i=i(a=e),e=""===s?"."+S(a,0):s,_(i)?(o="",null!=e&&(o=e.replace(C,"$&/")+"/"),T(i,n,o,"",(function(e){return e}))):null!=i&&(E(i)&&(i=function(e,n){return{$$typeof:t,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}(i,o+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(C,"$&/")+"/")+e)),n.push(i)),1;if(a=0,s=""===s?".":s+":",_(e))for(var u=0;u<e.length;u++){var l=s+S(c=e[u],u);a+=T(c,n,o,l,i)}else if(l=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"==typeof l)for(e=l.call(e),u=0;!(c=e.next()).done;)a+=T(c=c.value,n,o,l=s+S(c,u++),i);else if("object"===c)throw n=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return a}function R(e,n,t){if(null==e)return e;var r=[],o=0;return T(e,r,"","",(function(e){return n.call(t,e,o++)})),r}function O(e){if(-1===e._status){var n=e._result;(n=n()).then((function(n){0!==e._status&&-1!==e._status||(e._status=1,e._result=n)}),(function(n){0!==e._status&&-1!==e._status||(e._status=2,e._result=n)})),-1===e._status&&(e._status=0,e._result=n)}if(1===e._status)return e._result.default;throw e._result}var L={current:null},$={transition:null},I={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:$,ReactCurrentOwner:w};function D(){throw Error("act(...) is not supported in production builds of React.")}n.Children={map:R,forEach:function(e,n,t){R(e,(function(){n.apply(this,arguments)}),t)},count:function(e){var n=0;return R(e,(function(){n++})),n},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},n.Component=m,n.Fragment=o,n.Profiler=i,n.PureComponent=x,n.StrictMode=s,n.Suspense=l,n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I,n.act=D,n.cloneElement=function(e,n,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=y({},e.props),s=e.key,i=e.ref,c=e._owner;if(null!=n){if(void 0!==n.ref&&(i=n.ref,c=w.current),void 0!==n.key&&(s=""+n.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(u in n)j.call(n,u)&&!k.hasOwnProperty(u)&&(o[u]=void 0===n[u]&&void 0!==a?a[u]:n[u])}var u=arguments.length-2;if(1===u)o.children=r;else if(1<u){a=Array(u);for(var l=0;l<u;l++)a[l]=arguments[l+2];o.children=a}return{$$typeof:t,type:e.type,key:s,ref:i,props:o,_owner:c}},n.createContext=function(e){return(e={$$typeof:a,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:c,_context:e},e.Consumer=e},n.createElement=P,n.createFactory=function(e){var n=P.bind(null,e);return n.type=e,n},n.createRef=function(){return{current:null}},n.forwardRef=function(e){return{$$typeof:u,render:e}},n.isValidElement=E,n.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:O}},n.memo=function(e,n){return{$$typeof:d,type:e,compare:void 0===n?null:n}},n.startTransition=function(e){var n=$.transition;$.transition={};try{e()}finally{$.transition=n}},n.unstable_act=D,n.useCallback=function(e,n){return L.current.useCallback(e,n)},n.useContext=function(e){return L.current.useContext(e)},n.useDebugValue=function(){},n.useDeferredValue=function(e){return L.current.useDeferredValue(e)},n.useEffect=function(e,n){return L.current.useEffect(e,n)},n.useId=function(){return L.current.useId()},n.useImperativeHandle=function(e,n,t){return L.current.useImperativeHandle(e,n,t)},n.useInsertionEffect=function(e,n){return L.current.useInsertionEffect(e,n)},n.useLayoutEffect=function(e,n){return L.current.useLayoutEffect(e,n)},n.useMemo=function(e,n){return L.current.useMemo(e,n)},n.useReducer=function(e,n,t){return L.current.useReducer(e,n,t)},n.useRef=function(e){return L.current.useRef(e)},n.useState=function(e){return L.current.useState(e)},n.useSyncExternalStore=function(e,n,t){return L.current.useSyncExternalStore(e,n,t)},n.useTransition=function(){return L.current.useTransition()},n.version="18.3.1"},827378:(e,n,t)=>{e.exports=t(541535)},824246:(e,n,t)=>{e.exports=t(371426)},511151:(e,n,t)=>{t.d(n,{Z:()=>c,a:()=>i});var r=t(667294);const o={},s=r.createContext(o);function i(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);