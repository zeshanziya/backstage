/*! For license information please see 7cda5ea3.c64bfcc4.js.LICENSE.txt */
"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([[774410],{424188:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var r=t(824246),i=t(511151);const o={id:"defining",title:"Defining Configuration for your Plugin",description:"Documentation on Defining Configuration for your Plugin"},a=void 0,s={id:"conf/defining",title:"Defining Configuration for your Plugin",description:"Documentation on Defining Configuration for your Plugin",source:"@site/../docs/conf/defining.md",sourceDirName:"conf",slug:"/conf/defining",permalink:"/docs/conf/defining",draft:!1,unlisted:!1,editUrl:"https://github.com/backstage/backstage/edit/master/docs/../docs/conf/defining.md",tags:[],version:"current",frontMatter:{id:"defining",title:"Defining Configuration for your Plugin",description:"Documentation on Defining Configuration for your Plugin"},sidebar:"docs",previous:{title:"Writing Backstage Configuration Files",permalink:"/docs/conf/writing"},next:{title:"Authentication in Backstage",permalink:"/docs/auth/"}},c={},l=[{value:"Schema Collection and Definition",id:"schema-collection-and-definition",level:2},{value:"Visibility",id:"visibility",level:2},{value:"Validation",id:"validation",level:2},{value:"Guidelines",id:"guidelines",level:2}];function u(e){const n=Object.assign({p:"p",a:"a",h2:"h2",code:"code",pre:"pre",blockquote:"blockquote",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td"},(0,i.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["Configuration in Backstage is organized via a configuration schema, which in\nturn is defined using a superset of\n",(0,r.jsx)(n.a,{href:"https://json-schema.org/specification-links.html#draft-7",children:"JSON Schema Draft-07"}),".\nEach plugin or package within a Backstage app can contribute to the schema,\nwhich during validation is stitched together into a single schema."]}),"\n",(0,r.jsx)(n.h2,{id:"schema-collection-and-definition",children:"Schema Collection and Definition"}),"\n",(0,r.jsxs)(n.p,{children:['Schemas are collected from all packages and dependencies in each repo that are a\npart of the Backstage ecosystem, including the root package and transitive\ndependencies. The current definition of "part of the ecosystem" is that a\npackage has at least one dependency in the ',(0,r.jsx)(n.code,{children:"@backstage"})," namespace or a\n",(0,r.jsx)(n.code,{children:'"configSchema"'})," field in ",(0,r.jsx)(n.code,{children:"package.json"}),", but this is subject to change."]}),"\n",(0,r.jsxs)(n.p,{children:["Each package is searched for a schema at a single point of entry, a top-level\n",(0,r.jsx)(n.code,{children:'"configSchema"'})," field in ",(0,r.jsx)(n.code,{children:"package.json"}),". The field can either contain an\ninlined JSON schema, or a relative path to a schema file. Supported schema file\nformats are ",(0,r.jsx)(n.code,{children:".json"})," or ",(0,r.jsx)(n.code,{children:".d.ts"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-jsonc",metastring:'title="package.json"',children:'{\n  // ...\n  "files": [\n    // ...\n    "config.d.ts"\n  ],\n  "configSchema": "config.d.ts"\n}\n'})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["When defining a schema file, be sure to include the file in your\n",(0,r.jsx)(n.code,{children:"package.json"})," > ",(0,r.jsx)(n.code,{children:'"files"'})," field as well!"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["TypeScript configuration schema files should export a single ",(0,r.jsx)(n.code,{children:"Config"})," type, for\nexample:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export interface Config {\n  app: {\n    /**\n     * Frontend root URL\n     * @visibility frontend\n     */\n    baseUrl: string;\n\n    // Use @items.<name> to assign annotations to primitive array items\n    /** @items.visibility frontend */\n    myItems: string[];\n  };\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Separate ",(0,r.jsx)(n.code,{children:".json"})," schema files can use a top-level\n",(0,r.jsx)(n.code,{children:'"$schema": "https://backstage.io/schema/config-v1"'})," declaration in order to\nreceive schema validation and autocompletion. For example:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "$schema": "https://backstage.io/schema/config-v1",\n  "type": "object",\n  "properties": {\n    "app": {\n      "type": "object",\n      "properties": {\n        "baseUrl": {\n          "type": "string",\n          "description": "Frontend root URL",\n          "visibility": "frontend"\n        }\n      },\n      "required": ["baseUrl"]\n    },\n    "required": ["app"]\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"visibility",children:"Visibility"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"https://backstage.io/schema/config-v1"})," meta schema is a superset of JSON\nSchema Draft 07. The single addition is a custom ",(0,r.jsx)(n.code,{children:"visibility"})," keyword, which is\nused to indicate whether the given config value should be visible in the\nfrontend or not. The possible values are ",(0,r.jsx)(n.code,{children:"frontend"}),", ",(0,r.jsx)(n.code,{children:"backend"}),", and ",(0,r.jsx)(n.code,{children:"secret"}),",\nwhere ",(0,r.jsx)(n.code,{children:"backend"})," is the default. A visibility of ",(0,r.jsx)(n.code,{children:"secret"})," has the same scope at\nruntime, but it will be treated with more care in certain contexts, and defining\nboth ",(0,r.jsx)(n.code,{children:"frontend"})," and ",(0,r.jsx)(n.code,{children:"secret"})," for the same value in two different schemas will\nresult in an error during schema merging."]}),"\n",(0,r.jsxs)(n.p,{children:["The visibility only applies to the direct parent of where the keyword is placed\nin the schema. For example, if you set the visibility to ",(0,r.jsx)(n.code,{children:"frontend"})," for a subset\nof the schema with ",(0,r.jsx)(n.code,{children:'type: "object"'}),", but none of the descendants, only an empty\nobject will be available in the frontend. The full ancestry does not need to\nhave correctly defined visibilities however, so it is enough to only for example\ndeclare the visibility of a leaf node of ",(0,r.jsx)(n.code,{children:'type: "string"'}),"."]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.code,{children:"visibility"})}),(0,r.jsx)(n.th,{})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"frontend"})}),(0,r.jsx)(n.td,{children:"Visible in frontend and backend"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"backend"})}),(0,r.jsx)(n.td,{children:"(Default) Only in backend"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"secret"})}),(0,r.jsx)(n.td,{children:"Only in backend and may be excluded from logs for security reasons"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["You can set visibility with an ",(0,r.jsx)(n.code,{children:"@visibility"})," comment in the ",(0,r.jsx)(n.code,{children:"Config"})," Typescript\ninterface."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export interface Config {\n  app: {\n    /**\n     * Frontend root URL\n     * @visibility frontend\n     */\n    baseUrl: string;\n  };\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"validation",children:"Validation"}),"\n",(0,r.jsxs)(n.p,{children:["Schemas can be validated using the ",(0,r.jsx)(n.code,{children:"backstage-cli config:check"})," command. If you\nwant to validate anything else than the default ",(0,r.jsx)(n.code,{children:"app-config.yaml"}),", be sure to\npass in all of the configuration files as ",(0,r.jsx)(n.code,{children:"--config <path>"})," options as well."]}),"\n",(0,r.jsxs)(n.p,{children:["To validate and examine the frontend configuration, use the\n",(0,r.jsx)(n.code,{children:"backstage-cli config:print --frontend"})," command. Just like for validation you\nmay need to pass in all files using one or multiple ",(0,r.jsx)(n.code,{children:"--config <path>"})," options."]}),"\n",(0,r.jsx)(n.h2,{id:"guidelines",children:"Guidelines"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Make limited use of static configuration. The first question to ask is whether\na particular option actually needs to be static configuration, or if it might\njust as well be a TypeScript API. In general, options that you want to be able\nto change for different deployment environments should be static\nconfiguration, while it should otherwise be avoided."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["When defining configuration for your plugin, keep keys on ",(0,r.jsx)(n.code,{children:"camelCase"})," form and stick to\nexisting casing conventions such as ",(0,r.jsx)(n.code,{children:"baseUrl"})," rather than ",(0,r.jsx)(n.code,{children:"baseURL"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"It is also usually best to prefer objects over arrays, as it makes it possible\nto override individual values using separate files or environment variables."}),"\n",(0,r.jsx)(n.p,{children:"Avoid creating new top-level fields as much as possible. Either place your\nconfiguration within an existing known top-level block, or create a single new\none using e.g. the name of the product that the plugin integrates."})]})}const d=function(e={}){const{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?(0,r.jsx)(n,Object.assign({},e,{children:(0,r.jsx)(u,e)})):u(e)}},371426:(e,n,t)=>{var r=t(827378),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,n,t){var r,o={},l=null,u=null;for(r in void 0!==t&&(l=""+t),void 0!==n.key&&(l=""+n.key),void 0!==n.ref&&(u=n.ref),n)a.call(n,r)&&!c.hasOwnProperty(r)&&(o[r]=n[r]);if(e&&e.defaultProps)for(r in n=e.defaultProps)void 0===o[r]&&(o[r]=n[r]);return{$$typeof:i,type:e,key:l,ref:u,props:o,_owner:s.current}}n.Fragment=o,n.jsx=l,n.jsxs=l},541535:(e,n)=>{var t=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),h=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,g={};function m(e,n,t){this.props=e,this.context=n,this.refs=g,this.updater=t||p}function b(){}function j(e,n,t){this.props=e,this.context=n,this.refs=g,this.updater=t||p}m.prototype.isReactComponent={},m.prototype.setState=function(e,n){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=m.prototype;var x=j.prototype=new b;x.constructor=j,y(x,m.prototype),x.isPureReactComponent=!0;var v=Array.isArray,k=Object.prototype.hasOwnProperty,_={current:null},w={key:!0,ref:!0,__self:!0,__source:!0};function S(e,n,r){var i,o={},a=null,s=null;if(null!=n)for(i in void 0!==n.ref&&(s=n.ref),void 0!==n.key&&(a=""+n.key),n)k.call(n,i)&&!w.hasOwnProperty(i)&&(o[i]=n[i]);var c=arguments.length-2;if(1===c)o.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];o.children=l}if(e&&e.defaultProps)for(i in c=e.defaultProps)void 0===o[i]&&(o[i]=c[i]);return{$$typeof:t,type:e,key:a,ref:s,props:o,_owner:_.current}}function C(e){return"object"==typeof e&&null!==e&&e.$$typeof===t}var E=/\/+/g;function R(e,n){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return n[e]}))}(""+e.key):n.toString(36)}function O(e,n,i,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c=!1;if(null===e)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case t:case r:c=!0}}if(c)return a=a(c=e),e=""===o?"."+R(c,0):o,v(a)?(i="",null!=e&&(i=e.replace(E,"$&/")+"/"),O(a,n,i,"",(function(e){return e}))):null!=a&&(C(a)&&(a=function(e,n){return{$$typeof:t,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||c&&c.key===a.key?"":(""+a.key).replace(E,"$&/")+"/")+e)),n.push(a)),1;if(c=0,o=""===o?".":o+":",v(e))for(var l=0;l<e.length;l++){var u=o+R(s=e[l],l);c+=O(s,n,i,u,a)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),l=0;!(s=e.next()).done;)c+=O(s=s.value,n,i,u=o+R(s,l++),a);else if("object"===s)throw n=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return c}function $(e,n,t){if(null==e)return e;var r=[],i=0;return O(e,r,"","",(function(e){return n.call(t,e,i++)})),r}function P(e){if(-1===e._status){var n=e._result;(n=n()).then((function(n){0!==e._status&&-1!==e._status||(e._status=1,e._result=n)}),(function(n){0!==e._status&&-1!==e._status||(e._status=2,e._result=n)})),-1===e._status&&(e._status=0,e._result=n)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},T={transition:null},U={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:T,ReactCurrentOwner:_};n.Children={map:$,forEach:function(e,n,t){$(e,(function(){n.apply(this,arguments)}),t)},count:function(e){var n=0;return $(e,(function(){n++})),n},toArray:function(e){return $(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},n.Component=m,n.Fragment=i,n.Profiler=a,n.PureComponent=j,n.StrictMode=o,n.Suspense=u,n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U,n.cloneElement=function(e,n,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=y({},e.props),o=e.key,a=e.ref,s=e._owner;if(null!=n){if(void 0!==n.ref&&(a=n.ref,s=_.current),void 0!==n.key&&(o=""+n.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in n)k.call(n,l)&&!w.hasOwnProperty(l)&&(i[l]=void 0===n[l]&&void 0!==c?c[l]:n[l])}var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}return{$$typeof:t,type:e.type,key:o,ref:a,props:i,_owner:s}},n.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},n.createElement=S,n.createFactory=function(e){var n=S.bind(null,e);return n.type=e,n},n.createRef=function(){return{current:null}},n.forwardRef=function(e){return{$$typeof:l,render:e}},n.isValidElement=C,n.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:P}},n.memo=function(e,n){return{$$typeof:d,type:e,compare:void 0===n?null:n}},n.startTransition=function(e){var n=T.transition;T.transition={};try{e()}finally{T.transition=n}},n.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},n.useCallback=function(e,n){return D.current.useCallback(e,n)},n.useContext=function(e){return D.current.useContext(e)},n.useDebugValue=function(){},n.useDeferredValue=function(e){return D.current.useDeferredValue(e)},n.useEffect=function(e,n){return D.current.useEffect(e,n)},n.useId=function(){return D.current.useId()},n.useImperativeHandle=function(e,n,t){return D.current.useImperativeHandle(e,n,t)},n.useInsertionEffect=function(e,n){return D.current.useInsertionEffect(e,n)},n.useLayoutEffect=function(e,n){return D.current.useLayoutEffect(e,n)},n.useMemo=function(e,n){return D.current.useMemo(e,n)},n.useReducer=function(e,n,t){return D.current.useReducer(e,n,t)},n.useRef=function(e){return D.current.useRef(e)},n.useState=function(e){return D.current.useState(e)},n.useSyncExternalStore=function(e,n,t){return D.current.useSyncExternalStore(e,n,t)},n.useTransition=function(){return D.current.useTransition()},n.version="18.2.0"},827378:(e,n,t)=>{e.exports=t(541535)},824246:(e,n,t)=>{e.exports=t(371426)},511151:(e,n,t)=>{t.d(n,{Zo:()=>s,ah:()=>o});var r=t(667294);const i=r.createContext({});function o(e){const n=r.useContext(i);return r.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}const a={};function s({components:e,children:n,disableParentContext:t}){let s;return s=t?"function"==typeof e?e({}):e||a:o(e),r.createElement(i.Provider,{value:s},n)}}}]);